{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | GVP ChatBot</title>
  <link rel="icon" type="image/png" href="{% static 'media/favicon.png' %}">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <style>
    /* Smooth animation for inputs */
    .animated-input {
      transition: all 0.3s ease-in-out;
    }
    .animated-input:focus {
      outline: none;
      border: 1px solid #703737;
      box-shadow: 0 0 0 3px rgba(112, 55, 55, 0.3);
      transform: scale(1.02);
    }

    /* Login button hover */
    .btn-login {
      background-color: #703737;
      transition: all 0.3s ease;
    }
    .btn-login:hover {
      background-color: #8c4b4b;
      transform: scale(1.05);
    }

    /* Success Alert Box */
    .alert-success {
      position: fixed;
      top: 1rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      border: 2px solid #28a745;
      background-color: #d4edda;
      color: #155724;
      font-weight: 500;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      z-index: 50;
      opacity: 0;
      animation: fadeInOut 4s forwards; 
    }

    /* Error Alert Box */
    .alert-error {
      position: fixed;
      top: 1rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      border: 2px solid #dc3545;
      background-color: #f8d7da;
      color: #721c24;
      font-weight: 500;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      z-index: 50;
      opacity: 0;
      animation: fadeInOut 4s forwards;
    }

    .alert-success svg, .alert-error svg {
      width: 24px;
      height: 24px;
    }

    @keyframes fadeInOut {
      0% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
      10% { opacity: 1; transform: translateX(-50%) translateY(0); }
      90% { opacity: 1; transform: translateX(-50%) translateY(0); }
      100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
    }
  </style>
</head>

<body class="h-screen flex flex-col bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 transition-colors duration-300">

<!-- Messages -->
{% if messages %}
  {% for message in messages %}
    {% if message.tags == "error" %}
      <div class="alert-error">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12"/>
        </svg>
        <span>{{ message }}</span>
      </div>
    {% else %}
      <div class="alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
        </svg>
        <span>{{ message }}</span>
      </div>
    {% endif %}
  {% endfor %}
{% endif %}

<!-- Header -->
<header class="bg-white dark:bg-gray-800 border-b px-4 py-3 flex items-center justify-between shadow-sm">
  <div></div>
  <h1 class="text-lg font-semibold text-gray-800 dark:text-gray-200 text-center">
    GVP University Help Desk AI Login
  </h1>
  <div class="flex items-center gap-3">
    <a href="{% url 'chatbot_home' %}" 
      class="px-3 py-1 rounded-lg text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center">
      <span class="material-symbols-outlined">robot_2</span>
    </a>

    <button id="themeToggle" class="px-3 py-1 rounded-lg text-sm hover:bg-gray-100 dark:hover:bg-gray-700">
      <span class="material-symbols-outlined">routine</span>
    </button>
  </div>
</header>

<!-- Login Section -->
<main class="flex-1 flex items-center justify-center p-6">
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg w-full max-w-md p-8">
    <div class="flex flex-col items-center mb-6">
      <img src="{% static 'media/gvlogo.png' %}" 
           alt="Gujarat Vidyapith Logo" 
           class="w-20 h-20 mb-3 rounded-full border border-gray-300 dark:border-gray-700 shadow-sm">
      <h2 class="text-2xl font-semibold text-center">Gujarat Vidyapith</h2>
      <p class="text-sm text-gray-500 dark:text-gray-400">Login to your account</p>
    </div>

    <form action="/login/" method="POST" class="space-y-4">
      {% csrf_token %}
      <div>
        <label for="login_identifier" class="block text-sm font-medium mb-1">Username or Email</label>
        <input type="text" id="login_identifier" name="login_identifier" required
          class="animated-input w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-transparent text-sm" 
          placeholder="Enter your username or email">
      </div>

      <div>
        <label for="password" class="block text-sm font-medium mb-1">Password</label>
        <input type="password" id="password" name="password" required
          class="animated-input w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-transparent text-sm" 
          placeholder="Enter your password">
      </div>

      <button type="submit" class="btn-login w-full text-white py-2 rounded-lg font-medium">
        Login
      </button>
    </form>

    <p class="text-center text-sm mt-4 text-gray-500 dark:text-gray-400">
        Don't have an account? 
        <a href="{% url 'register' %}" class="text-blue-600 hover:underline">Register</a>
    </p>
  </div>
</main>

<script>
  function setTheme(theme) {
    document.documentElement.classList.toggle('dark', theme === 'dark');
    localStorage.setItem('theme', theme);
  }

  function initializeTheme() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      setTheme(savedTheme);
    } else {
      setTheme(window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    }
  }

  initializeTheme();

  document.getElementById("themeToggle").addEventListener("click", () => {
    const current = document.documentElement.classList.contains("dark") ? "dark" : "light";
    setTheme(current === "dark" ? "light" : "dark");
  });
</script>

</body>
</html>
